utility functions for version 1 and version 2 and version 3
